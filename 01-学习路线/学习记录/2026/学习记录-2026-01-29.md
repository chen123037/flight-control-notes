# 学习记录 - 2026-01-29

## 今日学习主题
- 早上：ArduPlane 安全与限制参数实战（`RTL_ALTITUDE` / `FENCE_ENABLE` / `ARMING_*` / `FS_SHORT_ACTN` / `FS_LONG_ACTN`）
- 下午：四元数 MAV 六自由度仿真实现（工具/动力学/力矩/仿真主程序/验证测试）

## 完成任务
- 备份参数与准备可触发 RTL 的航线环境。
- 完成 RTL 基线记录（`alt/targetalt` 曲线、模式与告警）。
- 修改 `RTL_ALTITUDE=80` 并验证盘旋高度跟随变化。
- 启用 `FENCE_ENABLE=1` 并触发围栏越界，记录模式与告警。
- 梳理解锁检查在当前固件的 `ARMING_*` 参数组含义与记录方法。
- 完成四元数仿真模块实现与集成，形成统一入口与可视化。
- 完成 5 项验证测试：互转一致性、归一化、重力计算、仿真对比与大角度机动。

## 遇到的问题
- 当前固件未提供 `ARMING_CHECK`，需转用 `ARMING_*` 参数组进行解锁检查理解与排错。
- 部分固件可能缺失 `ARSPD_FBW_MIN/MAX`，该实验可跳过。
- 四元数仿真暂无明显异常，验证通过。

## 关键结论
- 飞行限制/故障保护/解锁检查分别对应边界约束、失控后动作、上电前风险过滤。
- `RTL_ALTITUDE` 改动后返航盘旋高度同步生效，曲线可用于直接验证。
- 围栏越界可触发保护动作（RTL）并出现明确告警提示。
- 安全参数实验必须记录“触发条件 → 行为变化 → 结果曲线/告警”的闭环。
- 四元数方案避免万向锁，外部欧拉角输入输出与内部四元数计算可兼容旧接口。
- 四元数运动学方程与正交性控制工作正常，验证误差满足精度要求。

## 下一步
- 补齐 `FS_SHORT_ACTN/FS_LONG_ACTN` 的触发实验与记录。
- 若参数存在，低幅度尝试 `ARSPD_FBW_MIN/MAX`，完善速度限制判读。
- 按截图清单补齐关键截图并归档。
- 将四元数仿真作为默认入口，保留欧拉角版本用于兼容。

## 关联笔记
- `../../04-ArduPlane参数/10-安全与限制参数实战指南.md`
- `../../06-实践记录/SITL/20260129.waypoints`
- `../../09-知识卡片/小型无人机理论与控制/知识卡片-安全与限制参数边界与实验链路.md`
- `../../09-知识卡片/小型无人机理论与控制/知识卡片-RTL高度与围栏触发判读.md`
- `../../书籍阅读/读书笔记/小型无人机理论与控制/本书小项目/四元数实现总结.md`